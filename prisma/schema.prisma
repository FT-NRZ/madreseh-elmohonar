generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model attendances {
  id           Int      @id @default(autoincrement())
  student_id   Int
  class_id     Int
  date         DateTime @db.Date
  status       String   @db.VarChar(10)
  reason       String?
  is_justified Boolean  @default(false)
  notes        String?
  created_by   Int?
  created_at   DateTime @default(now()) @db.Timestamp(6)
  updated_at   DateTime @default(now()) @db.Timestamp(6)
  delay_minutes Int?    // ØªØ§Ø®ÛŒØ± Ø¨Ù‡ Ø¯Ù‚ÛŒÙ‚Ù‡
  delay_reason  String? @db.VarChar(200) // Ø¯Ù„ÛŒÙ„ ØªØ§Ø®ÛŒØ±
  classes      classes  @relation(fields: [class_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users        users?   @relation(fields: [created_by], references: [id], onUpdate: NoAction)
  students     students @relation(fields: [student_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([student_id, date], map: "uq_attendance_per_student_date")
}

model class_news {
  id           Int      @id @default(autoincrement())
  class_id     Int
  title        String   @db.VarChar(200)
  content      String
  is_important Boolean  @default(false)
  author_id    Int?
  created_at   DateTime @default(now()) @db.Timestamp(6)
  updated_at   DateTime @default(now()) @db.Timestamp(6)
  users        users?   @relation(fields: [author_id], references: [id], onUpdate: NoAction)
  classes      classes  @relation(fields: [class_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model classes {
  id              Int               @id @default(autoincrement())
  class_name      String            @db.VarChar(50)
  class_number    String            @db.VarChar(10)
  grade_id        Int
  teacher_id      Int?
  capacity        Int               @default(30)
  description     String?
  academic_year   String            @db.VarChar(10)
  created_at      DateTime          @default(now()) @db.Timestamp(6)
  updated_at      DateTime          @default(now()) @db.Timestamp(6)
  attendances     attendances[]
  class_news      class_news[]
  grades          grades            @relation(fields: [grade_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  teachers        teachers?         @relation(fields: [teacher_id], references: [id], onUpdate: NoAction)
  exams           exams[]
  gallery_images  gallery_images[]
  students        students[]
  weekly_schedule weekly_schedule[]
  special_classes special_classes[]

  @@unique([grade_id, class_number, academic_year], map: "uq_class_number_per_grade_year")
}

model comments_suggestions {
  id           Int      @id @default(autoincrement())
  user_id      Int
  subject      String?  @db.VarChar(200)
  content      String
  is_anonymous Boolean  @default(false)
  is_approved  Boolean  @default(false)
  created_at   DateTime @default(now()) @db.Timestamp(6)
  users        users    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model entrances {
  id                Int                 @id @default(autoincrement())
  user_id           Int                 @unique
  national_code     String              @unique @db.VarChar(10)
  password_hash     String              @db.VarChar(255)
  role              String              @db.VarChar(20)
  last_login_at     DateTime?           @db.Timestamp(6)
  failed_attempts   Int                 @default(0)
  locked_until      DateTime?           @db.Timestamp(6)
  is_active         Boolean             @default(true)
  created_at        DateTime            @default(now()) @db.Timestamp(6)
  updated_at        DateTime            @default(now()) @db.Timestamp(6)
  users             users               @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  password_recovery password_recovery[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model exam_questions {
  id               Int                @id @default(autoincrement())
  exam_id          Int
  question_text    String
  question_type    String             @default("multiple_choice") @db.VarChar(20)
  marks            Decimal            @db.Decimal(5, 2)
  sort_order       Int                @default(0)
  created_at       DateTime           @default(now()) @db.Timestamp(6)
  updated_at       DateTime           @default(now()) @db.Timestamp(6)
  exams            exams              @relation(fields: [exam_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  question_options question_options[]
  student_answers  student_answers[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model exam_results {
  id              Int               @id @default(autoincrement())
  exam_id         Int
  student_id      Int
  marks_obtained  Decimal?          @db.Decimal(6, 2) // Ù†Ù…Ø±Ù‡ Ø¹Ø¯Ø¯ÛŒ (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)
  grade_desc      String?           // Ù†Ù…Ø±Ù‡ ØªÙˆØµÛŒÙÛŒ (Ø¹Ø§Ù„ÛŒØŒ Ø®ÛŒÙ„ÛŒ Ø®ÙˆØ¨ Ùˆ ...)
  status          String?           @db.VarChar(10)
  attempt_number  Int               @default(1)
  completed_at    DateTime?         @db.Timestamp(6)
  created_at      DateTime          @default(now()) @db.Timestamp(6)
  updated_at      DateTime          @default(now()) @db.Timestamp(6)
  exams           exams             @relation(fields: [exam_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  students        students          @relation(fields: [student_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  student_answers student_answers[]

  @@unique([exam_id, student_id, attempt_number], map: "uq_exam_attempt")
}

model exams {
  id                      Int                @id @default(autoincrement())
  title                   String             @db.VarChar(200)
  type                    String             @db.VarChar(20)
  description             String?
  subject                 String?            @db.VarChar(100)
  class_id                Int?
  grade_id                Int?               // â† Ø§ÛŒÙ† Ø®Ø· Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†
  teacher_id              Int?
  duration_minutes        Int
  total_marks             Decimal            @db.Decimal(6, 2)
  start_time              DateTime?          @db.Timestamp(6)
  end_time                DateTime?          @db.Timestamp(6)
  is_active               Boolean            @default(true)
  show_result_immediately Boolean            @default(true)
  max_attempts            Int                @default(1)
  pdf_url                 String?            @db.VarChar(255)
  image_url               String?            @db.VarChar(255)
  questions               String?
  created_at              DateTime           @default(now()) @db.Timestamp(6)
  updated_at              DateTime           @default(now()) @db.Timestamp(6)
  exam_questions          exam_questions[]
  exam_results            exam_results[]
  classes                 classes?           @relation(fields: [class_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  grades                  grades?            @relation(fields: [grade_id], references: [id], onDelete: Cascade, onUpdate: NoAction) // â† Ø§ÛŒÙ† Ø®Ø· Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†
  teachers                teachers?          @relation(fields: [teacher_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  exam_file_answers       exam_file_answers[]
}

model gallery_categories {
  id                       Int                  @id @default(autoincrement())
  name                     String               @db.VarChar(100)
  description              String?
  parent_id                Int?
  is_active                Boolean              @default(true)
  sort_order               Int                  @default(0)
  created_at               DateTime             @default(now()) @db.Timestamp(6)
  updated_at               DateTime             @default(now()) @db.Timestamp(6)
  gallery_categories       gallery_categories?  @relation("gallery_categoriesTogallery_categories", fields: [parent_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  other_gallery_categories gallery_categories[] @relation("gallery_categoriesTogallery_categories")
  gallery_images           gallery_images[]
}

model gallery_images {
  id                 Int                @id @default(autoincrement())
  category_id        Int
  class_id           Int?
  grade_id           Int?               // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
  title              String?            @db.VarChar(200)
  description        String?
  image_path         String             @db.VarChar(255)
  alt_text           String?            @db.VarChar(200)
  is_featured        Boolean            @default(false)
  created_at         DateTime           @default(now()) @db.Timestamp(6)
  updated_at         DateTime           @default(now()) @db.Timestamp(6)
  gallery_categories gallery_categories @relation(fields: [category_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  classes            classes?           @relation(fields: [class_id], references: [id], onUpdate: NoAction)
  grades             grades?            @relation(fields: [grade_id], references: [id], onUpdate: NoAction) // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
}

model grades {
  id                Int                 @id @default(autoincrement())
  grade_name        String              @db.VarChar(50)
  grade_level       Int                 @unique
  description       String?
  created_at        DateTime            @default(now()) @db.Timestamp(6)
  updated_at        DateTime            @default(now()) @db.Timestamp(6)
  classes           classes[]
  pre_registrations pre_registrations[]
  gallery_images    gallery_images[]
  teacher_news      teacher_news[]      @relation("GradeNews")
  exams             exams[]             // â† Ø§ÛŒÙ† Ø®Ø· Ø±Ø§ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model meal_schedule {
  id          Int      @id @default(autoincrement())
  date        DateTime @db.Date
  meal_type   String   @db.VarChar(10)
  meal_name   String   @db.VarChar(200)
  description String?
  created_by  Int?
  created_at  DateTime @default(now()) @db.Timestamp(6)
  updated_at  DateTime @default(now()) @db.Timestamp(6)
  users       users?   @relation(fields: [created_by], references: [id], onUpdate: NoAction)

  @@unique([date, meal_type], map: "uq_meal_per_day")
}

model news_announcements {
  id           Int       @id @default(autoincrement())
  title        String    @db.VarChar(200)
  content      String
  is_published Boolean   @default(false)
  publish_date DateTime? @db.Date
  author_id    Int?
  image_url    String?   @db.VarChar(255) // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
  target_type  String    @default("public") @db.VarChar(20) // public, teachers, students - Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
  target_user_id Int?    // Ø¨Ø±Ø§ÛŒ Ø§Ø±Ø³Ø§Ù„ Ø¨Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø®Ø§Øµ - Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
  created_at   DateTime  @default(now()) @db.Timestamp(6)
  updated_at   DateTime  @default(now()) @db.Timestamp(6)
  users        users?    @relation(fields: [author_id], references: [id], onUpdate: NoAction)
  target_user  users?    @relation("NewsTarget", fields: [target_user_id], references: [id], onUpdate: NoAction) // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
}

model password_recovery {
  id                Int        @id @default(autoincrement())
  entrance_id       Int?
  phone             String     @db.VarChar(20)
  verification_code String     @db.VarChar(10)
  expiration_time   DateTime   @db.Timestamp(6)
  is_used           Boolean    @default(false)
  used_at           DateTime?  @db.Timestamp(6)
  attempts          Int        @default(0)
  created_at        DateTime   @default(now()) @db.Timestamp(6)
  entrances         entrances? @relation(fields: [entrance_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model pre_registrations {
  id             Int      @id @default(autoincrement())
  first_name     String   @db.VarChar(100)
  last_name      String   @db.VarChar(100)
  phone          String   @db.VarChar(20)
  grade_interest Int?
  status         String   @default("pending") @db.VarChar(20)
  notes          String?
  created_at     DateTime @default(now()) @db.Timestamp(6)
  updated_at     DateTime @default(now()) @db.Timestamp(6)
  grades         grades?  @relation(fields: [grade_interest], references: [id], onUpdate: NoAction)
}

model question_options {
  id              Int               @id @default(autoincrement())
  question_id     Int
  option_text     String
  is_correct      Boolean           @default(false)
  sort_order      Int               @default(0)
  created_at      DateTime          @default(now()) @db.Timestamp(6)
  updated_at      DateTime          @default(now()) @db.Timestamp(6)
  exam_questions  exam_questions    @relation(fields: [question_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  student_answers student_answers[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model report_cards {
  id            Int       @id @default(autoincrement())
  student_id    Int
  semester      String    @db.VarChar(10)
  academic_year String    @db.VarChar(10)
  subject       String    @db.VarChar(100)
  midterm_score Decimal?  @db.Decimal(5, 2)
  final_score   Decimal?  @db.Decimal(5, 2)
  total_score   Decimal?  @db.Decimal(5, 2)
  grade         String?   @db.VarChar(5)
  teacher_id    Int?
  created_at    DateTime  @default(now()) @db.Timestamp(6)
  updated_at    DateTime  @default(now()) @db.Timestamp(6)
  students      students  @relation(fields: [student_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  teachers      teachers? @relation(fields: [teacher_id], references: [id], onUpdate: NoAction)

  @@unique([student_id, academic_year, semester, subject], map: "uq_report_card")
}

model student_answers {
  id                 Int               @id @default(autoincrement())
  result_id          Int
  question_id        Int
  selected_option_id Int?
  answer_text        String?
  is_correct         Boolean           @default(false)
  marks_awarded      Decimal           @default(0) @db.Decimal(5, 2)
  created_at         DateTime          @default(now()) @db.Timestamp(6)
  exam_questions     exam_questions    @relation(fields: [question_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  exam_results       exam_results      @relation(fields: [result_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  question_options   question_options? @relation(fields: [selected_option_id], references: [id], onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model students {
  id                Int                 @id @default(autoincrement())
  user_id           Int                 @unique
  student_number    String              @unique @db.VarChar(20)
  class_id          Int?
  father_name       String?             @db.VarChar(100)
  mother_name       String?             @db.VarChar(100)
  parent_phone      String?             @db.VarChar(20)
  enrollment_date   DateTime            @db.Date
  status            String              @default("active") @db.VarChar(20)
  created_at        DateTime            @default(now()) @db.Timestamp(6)
  updated_at        DateTime            @default(now()) @db.Timestamp(6)
  attendances       attendances[]
  exam_results      exam_results[]
  report_cards      report_cards[]
  classes           classes?            @relation(fields: [class_id], references: [id], onUpdate: NoAction)
  users             users               @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  exam_file_answers exam_file_answers[]
  student_teacher   student_teacher[]
  teacher_news      teacher_news[]      @relation("StudentNews") // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model teachers {
  id                   Int                      @id @default(autoincrement())
  user_id              Int                      @unique
  teacher_code         String                   @unique @db.VarChar(20)
  hire_date            DateTime                 @db.Date
  subject              String?                  @db.VarChar(100)
  teaching_type        String                   @default("grade") @db.VarChar(20) // ğŸ”¥ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
  workshop_id          Int?                     // ğŸ”¥ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
  education_level      String?                  @db.VarChar(100)
  status               String                   @default("active") @db.VarChar(20)
  created_at           DateTime                 @default(now()) @db.Timestamp(6)
  updated_at           DateTime                 @default(now()) @db.Timestamp(6)
  
  classes              classes[]
  exams                exams[]
  report_cards         report_cards[]
  users                users                    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  workshop             workshops?               @relation(fields: [workshop_id], references: [id]) // ğŸ”¥ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
  weekly_schedule      weekly_schedule[]
  student_teacher      student_teacher[]
  disciplinary_actions disciplinary_actions[]  // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
}

model refreshTokens {
  id         Int      @id @default(autoincrement())
  user_id    Int
  token_hash String   @db.VarChar(255)
  expires_at DateTime @db.Timestamp(6)
  created_at DateTime @default(now()) @db.Timestamp(6)
  users      users    @relation(fields: [user_id], references: [id], onDelete: Cascade)
  
  @@map("refresh_tokens")
}

model users {
  id                   Int                    @id @default(autoincrement())
  username             String?                @unique @db.VarChar(50)
  first_name           String                 @db.VarChar(100)
  last_name            String                 @db.VarChar(100)
  phone                String?                @unique @db.VarChar(20)
  email                String?                @unique @db.VarChar(100)
  address              String?
  profile_image        String?                @db.VarChar(255)
  birth_date           DateTime?              @db.Date
  is_active            Boolean                @default(true)
  created_at           DateTime               @default(now()) @db.Timestamp(6)
  updated_at           DateTime               @default(now()) @db.Timestamp(6)
  attendances          attendances[]
  refreshTokens        refreshTokens[]
  class_news           class_news[]
  comments_suggestions comments_suggestions[]
  entrances            entrances?
  meal_schedule        meal_schedule[]
  news_announcements   news_announcements[]
  targeted_news        news_announcements[]   @relation("NewsTarget") // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
  students             students?
  teachers             teachers?
  circulars            circulars[]            // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
  targeted_circulars   circulars[]            @relation("CircularTarget") // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
  circular_reads       circular_reads[]       @relation("CircularReads") // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
  disciplinary_actions disciplinary_actions[] // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
  teacher_news         teacher_news[]         // Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model weekly_schedule {
  id          Int       @id @default(autoincrement())
  class_id    Int
  day_of_week String    @db.VarChar(10)
  start_time  DateTime  @db.Time(6)
  end_time    DateTime  @db.Time(6)
  subject     String    @db.VarChar(100)
  teacher_id  Int?
  room_number String?   @db.VarChar(20)
  created_at  DateTime  @default(now()) @db.Timestamp(6)
  updated_at  DateTime  @default(now()) @db.Timestamp(6)
  classes     classes   @relation(fields: [class_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  teachers    teachers? @relation(fields: [teacher_id], references: [id], onUpdate: NoAction)

  @@unique([class_id, day_of_week, start_time], map: "uq_schedule_slot")
}

model exam_file_answers {
  id               Int      @id @default(autoincrement())
  exam_id          Int
  student_id       Int
  file_url         String
  grade_desc       String?  // Ù†Ù…Ø±Ù‡ ØªÙˆØµÛŒÙÛŒ (Ø¹Ø§Ù„ÛŒØŒ Ø®ÛŒÙ„ÛŒ Ø®ÙˆØ¨ Ùˆ ...)
  teacher_feedback String?  // ØªÙˆØ¶ÛŒØ­ Ù…Ø¹Ù„Ù…
  created_at       DateTime @default(now())
  exams            exams    @relation(fields: [exam_id], references: [id])
  students         students @relation(fields: [student_id], references: [id], onDelete: Cascade)
}

model food_schedule {
  id         Int      @id @default(autoincrement())
  week_start DateTime
  weekday    String
  date       DateTime
  breakfast  String?
  lunch      String?
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
}

model special_classes {
  id          Int      @id @default(autoincrement())
  title       String
  description String?
  class_id    Int?
  day_of_week String   // Ù…Ø«Ø§Ù„: 'saturday'
  start_time  String   // Ù…Ø«Ø§Ù„: '10:00'
  end_time    String   // Ù…Ø«Ø§Ù„: '12:00'
  created_at  DateTime @default(now())
  updated_at  DateTime @updatedAt

  classes     classes? @relation(fields: [class_id], references: [id])
}

model student_teacher {
  id          Int      @id @default(autoincrement())
  student_id  Int
  teacher_id  Int
  assigned_at DateTime @default(now()) @db.Timestamp(6)
  created_at  DateTime @default(now()) @db.Timestamp(6)
  
  student     students @relation(fields: [student_id], references: [id], onDelete: Cascade)
  teacher     teachers @relation(fields: [teacher_id], references: [id], onDelete: Cascade)
  
  @@unique([student_id, teacher_id])
}

model workshops {
  id           Int       @id @default(autoincrement())
  workshop_name String   @db.VarChar(100)
  icon         String?   @db.VarChar(10)
  description  String?
  is_active    Boolean   @default(true)
  created_at   DateTime  @default(now()) @db.Timestamp(6)
  updated_at   DateTime  @default(now()) @db.Timestamp(6)
  
  // Ø±Ø§Ø¨Ø·Ù‡ Ø¨Ø§ Ù…Ø¹Ù„Ù…Ø§Ù†
  teachers     teachers[]
}

model circulars {
  id                Int       @id @default(autoincrement())
  title             String    @db.VarChar(200)
  content           String
  image_url         String?   @db.VarChar(255)
  priority          String    @default("normal") @db.VarChar(20) // urgent, high, normal, low
  target_type       String    @default("all_teachers") @db.VarChar(20) // all_teachers, specific_teacher
  target_teacher_id Int?      // Ø¨Ø±Ø§ÛŒ Ù…Ø¹Ù„Ù… Ø®Ø§Øµ
  issue_date        DateTime  @db.Date
  expiry_duration   String    @default("1_month") @db.VarChar(20) // 10_days, 1_month, 3_months, 6_months
  expiry_date       DateTime  @db.Date
  is_active         Boolean   @default(true)
  is_read_required  Boolean   @default(false) // Ø¢ÛŒØ§ Ø®ÙˆØ§Ù†Ø¯Ù† Ø§Ø¬Ø¨Ø§Ø±ÛŒ Ø§Ø³Øª
  author_id         Int?
  circular_number   String?   @db.VarChar(50) // Ø´Ù…Ø§Ø±Ù‡ Ø¨Ø®Ø´Ù†Ø§Ù…Ù‡
  department        String?   @db.VarChar(100) // Ø¨Ø®Ø´ Ù…Ø±Ø¨ÙˆØ·Ù‡
  created_at        DateTime  @default(now()) @db.Timestamp(6)
  updated_at        DateTime  @default(now()) @db.Timestamp(6)
  users             users?    @relation(fields: [author_id], references: [id], onUpdate: NoAction)
  target_teacher    users?    @relation("CircularTarget", fields: [target_teacher_id], references: [id], onUpdate: NoAction)
  circular_reads    circular_reads[]
}

model circular_reads {
  id          Int       @id @default(autoincrement())
  circular_id Int
  teacher_id  Int
  read_at     DateTime  @default(now()) @db.Timestamp(6)
  circulars   circulars @relation(fields: [circular_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users       users     @relation("CircularReads", fields: [teacher_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  
  @@unique([circular_id, teacher_id])
}

model disciplinary_actions {
  id          Int      @id @default(autoincrement())
  teacher_id  Int
  type        String   @db.VarChar(20) // reward, warning
  severity    String   @default("normal") @db.VarChar(20) // mild, normal, severe (Ø¨Ø±Ø§ÛŒ ØªÙˆØ¨ÛŒØ®)
  level       String   @default("normal") @db.VarChar(20) // normal, high, excellent (Ø¨Ø±Ø§ÛŒ ØªØ´ÙˆÛŒÙ‚)
  title       String   @db.VarChar(200)
  description String?
  date        DateTime @db.Date
  author_id   Int?     // Ú©Ø³ÛŒ Ú©Ù‡ Ø«Ø¨Øª Ú©Ø±Ø¯Ù‡
  is_active   Boolean  @default(true)
  created_at  DateTime @default(now()) @db.Timestamp(6)
  updated_at  DateTime @default(now()) @db.Timestamp(6)
  teachers    teachers @relation(fields: [teacher_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  users       users?   @relation(fields: [author_id], references: [id], onUpdate: NoAction)
}

model teacher_news {
  id               Int      @id @default(autoincrement())
  title            String   @db.VarChar(200)
  content          String
  image_url        String?  @db.VarChar(255)
  target_type      String   @db.VarChar(20) // grade, specific_student, all_students
  target_grade_id  Int?
  target_student_id Int?
  is_important     Boolean  @default(false)
  reminder_date    DateTime? @db.Date
  author_id        Int      // Ù…Ø¹Ù„Ù… Ø³Ø§Ø²Ù†Ø¯Ù‡
  created_at       DateTime @default(now()) @db.Timestamp(6)
  updated_at       DateTime @default(now()) @db.Timestamp(6)
  
  // Ø±ÙˆØ§Ø¨Ø·
  users            users    @relation(fields: [author_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  target_grade     grades?  @relation("GradeNews", fields: [target_grade_id], references: [id], onUpdate: NoAction)
  target_student   students? @relation("StudentNews", fields: [target_student_id], references: [id], onUpdate: NoAction)
}